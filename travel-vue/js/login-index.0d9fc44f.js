(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["login-index"],{"1e4b":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-card",[r("h3",[e._v("相册")]),r("div",{staticClass:"operation"},[r("el-button",{on:{click:function(t){e.dialogVisible=!0}}},[e._v(" 创建相册 ")]),r("el-input",{attrs:{placeholder:"请输入查询关键字"},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}})],1),r("ul",{staticClass:"albumlist"},e._l(e.albumlist,(function(t){return r("li",{key:t.albumid,on:{click:function(r){return e.to(t)}}},[r("div",{staticClass:"albumlist-img"},[r("el-image",{attrs:{src:t.aPhoto&&1===t.albumtype?e.dfUrl+t.aPhoto.photoaddress:""}},[1===t.albumtype?r("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[r("i",{staticClass:"el-icon-picture-outline"})]):e._e(),2===t.albumtype?r("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[r("i",{staticClass:"el-icon-warning"})]):e._e()])],1),r("div",{staticClass:"albumlist-b"},[r("span",[e._v(e._s(t.albumname||"相册名称"))]),r("el-dropdown",{on:{command:e.handleCommand}},[r("span",{staticClass:"el-dropdown-link"},[e._v(" ..."),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{attrs:{command:{type:"alter",item:t}}},[e._v(" 修改 ")]),r("el-dropdown-item",{attrs:{command:{type:"del",item:t}}},[e._v(" 删除 ")])],1)],1)],1),r("div",{staticClass:"albumlist-desc",attrs:{title:t.albumdescribe}},[e._v(" "+e._s(t.albumdescribe||"描述")+" ")])])})),0)]),r("el-dialog",{attrs:{center:"",visible:e.dialogVisible,"before-close":e.handleClose,title:"创建相册",width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"addalbumFormref",attrs:{rules:e.rules,model:e.addalbumForm}},[r("el-form-item",{attrs:{prop:"albumname",label:"相册名称"}},[r("el-input",{model:{value:e.addalbumForm.albumname,callback:function(t){e.$set(e.addalbumForm,"albumname",t)},expression:"addalbumForm.albumname"}})],1),r("el-form-item",{attrs:{label:"描述",prop:"albumdescribe"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.addalbumForm.albumdescribe,callback:function(t){e.$set(e.addalbumForm,"albumdescribe",t)},expression:"addalbumForm.albumdescribe"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){return e.submit("addalbumFormref")}}},[e._v("提 交")]),r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")])],1)],1),r("el-dialog",{attrs:{center:"",visible:e.dialogVisible1,"before-close":e.handleClose1,title:"修改描述",width:"50%"},on:{"update:visible":function(t){e.dialogVisible1=t}}},[r("el-form",{ref:"alteralbumFormref",attrs:{rules:e.rules,model:e.alteralbumForm}},[r("el-form-item",{attrs:{prop:"albumname",label:"相册名称"}},[r("el-input",{model:{value:e.alteralbumForm.albumname,callback:function(t){e.$set(e.alteralbumForm,"albumname",t)},expression:"alteralbumForm.albumname"}})],1),r("el-form-item",{attrs:{label:"描述",prop:"albumdescribe"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.alteralbumForm.albumdescribe,callback:function(t){e.$set(e.alteralbumForm,"albumdescribe",t)},expression:"alteralbumForm.albumdescribe"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){return e.submit("alteralbumFormref")}}},[e._v("提交")]),r("el-button",{on:{click:function(t){e.dialogVisible1=!1}}},[e._v("取 消")])],1)],1)],1)},a=[],i=(r("caad"),r("45fc"),r("2532"),r("96cf"),r("1da1")),n={data:function(){return{query:"",id:JSON.parse(window.sessionStorage.user).userid||JSON.parse(window.sessionStorage.user).adminid,dialogVisible:!1,dialogVisible1:!1,isalter:!1,dfUrl:"http://localhost:10086/ps/",albumlist:[{}],allalbumlist:[],addalbumForm:{},alteralbumForm:{},rules:{albumname:[{required:!0,message:"请输入相册名",trigger:"blur"}],albumdescribe:[{required:!0,message:"请输入相册描述",trigger:"blur"}]}}},created:function(){this.getalbumlist()},methods:{getalbumlist:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("album/list",{params:{id:e.id}});case 2:r=t.sent,s=r.data,200===s.code&&(e.allalbumlist=s.obj,e.queryuserlist());case 5:case"end":return t.stop()}}),t)})))()},queryuserlist:function(){var e=this,t=[];this.allalbumlist.some((function(r){(r.albumname.includes(e.query)||r.albumdescribe.includes(e.query))&&t.push(r)})),this.albumlist=t},handleCommand:function(e){"alter"===e.type&&this.alter(e.item),"del"===e.type&&this.del(e.item)},alter:function(e){this.dialogVisible1=!0,this.alteralbumForm=e,this.isalter=!0},submit:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(r){var s,a,i,n,o,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",!1);case 2:if(!t.isalter){e.next=11;break}return s=t.alteralbumForm,a=s.albumid,i=s.albumdescribe,e.next=6,t.$http.post("user/updateAlbum",{id:a,changeWord:i});case 6:n=e.sent,n.data,t.handleClose1(),e.next=17;break;case 11:return t.addalbumForm.albumuserid=t.id,e.next=14,t.$http.post("user/addAlbum",t.addalbumForm);case 14:o=e.sent,l=o.data,200===l.code&&(t.getalbumlist(),t.queryuserlist(),t.handleClose());case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},del:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var s,a,i,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("是否确认删除该相册?","确认删除",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(s=r.sent,"confirm"==s){r.next=5;break}return r.abrupt("return",t.$message.info("已取消删除"));case 5:return a=e.albumid,r.next=8,t.$http.get("user/delAlbum",{params:{id:a}});case 8:i=r.sent,n=i.data,200===n.code&&(t.getalbumlist(),t.queryuserlist());case 11:case"end":return r.stop()}}),r)})))()},to:function(e){1===e.albumtype?this.$router.push("/album/"+e.albumid):this.$message({type:"error",message:"相册已被禁用"})},handleClose:function(){this.dialogVisible=!1},handleClose1:function(){this.dialogVisible1=!1}},watch:{query:function(e){this.queryuserlist()}}},o=n,l=(r("249f"),r("2877")),u=Object(l["a"])(o,s,a,!1,null,"3c344c43",null);t["default"]=u.exports},"249f":function(e,t,r){"use strict";var s=r("dc63"),a=r.n(s);a.a},2532:function(e,t,r){"use strict";var s=r("23e7"),a=r("5a34"),i=r("1d80"),n=r("ab13");s({target:"String",proto:!0,forced:!n("includes")},{includes:function(e){return!!~String(i(this)).indexOf(a(e),arguments.length>1?arguments[1]:void 0)}})},3348:function(e,t,r){"use strict";var s=r("7b7f"),a=r.n(s);a.a},"42f2":function(e,t,r){"use strict";var s=r("be0e"),a=r.n(s);a.a},"44e7":function(e,t,r){var s=r("861d"),a=r("c6b6"),i=r("b622"),n=i("match");e.exports=function(e){var t;return s(e)&&(void 0!==(t=e[n])?!!t:"RegExp"==a(e))}},"5a34":function(e,t,r){var s=r("44e7");e.exports=function(e){if(s(e))throw TypeError("The method doesn't accept regular expressions");return e}},7803:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login_container"},[r("div"),r("div",{staticClass:"bg"}),r("div",{staticClass:"login_box"},[r("h1",[e._v("注册")]),r("el-form",{ref:"registerFormref",staticClass:"login-form",attrs:{"lable-width":"0px",model:e.registerForm,rules:e.rules}},[r("el-form-item",{attrs:{prop:"username"}},[r("el-input",{ref:"username",attrs:{placeholder:"手机号"},model:{value:e.registerForm.username,callback:function(t){e.$set(e.registerForm,"username",t)},expression:"registerForm.username"}},[r("i",{staticClass:"el-input__icon el-icon-phone",attrs:{slot:"prefix"},slot:"prefix"})])],1),r("el-form-item",{attrs:{prop:"password"}},[r("el-input",{ref:"password",attrs:{type:"password",placeholder:"密码"},model:{value:e.registerForm.password,callback:function(t){e.$set(e.registerForm,"password",t)},expression:"registerForm.password"}},[r("i",{staticClass:"el-input__icon el-icon-lock",attrs:{slot:"prefix"},slot:"prefix"})])],1),r("el-form-item",{attrs:{prop:"repassword"}},[r("el-input",{ref:"password",attrs:{type:"password",placeholder:"确认密码"},model:{value:e.registerForm.repassword,callback:function(t){e.$set(e.registerForm,"repassword",t)},expression:"registerForm.repassword"}},[r("i",{staticClass:"el-input__icon el-icon-lock",attrs:{slot:"prefix"},slot:"prefix"})])],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("registerFormref")}}},[e._v(" 注册 ")])],1),r("el-form-item",[r("el-button",{staticClass:"back",on:{click:function(t){return e.reback()}}},[e._v(" 取消 ")])],1)],1)],1)])},a=[],i=(r("96cf"),r("1da1")),n={data:function(){var e=this,t=function(t,r,s){if(r===e.registerForm.password)return s();s(new Error("两次输入的密码不一致，请重新输入"))},r=function(e,t,r){var s=/^1[3456789]\d{9}$/;s.test(t)||""==t||void 0==t?r():r(new Error("请输入正确的手机号码"))},s=function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(r,s,a){var i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("user/isPhone",{params:{username:s}});case 2:i=t.sent,n=i.data,n.obj?a(new Error("已注册手机号")):a();case 5:case"end":return t.stop()}}),t)})));return function(e,r,s){return t.apply(this,arguments)}}(),a=function(e,t,r){var s=/^[a-zA-Z][a-zA-Z0-9_]*$/;s.test(t)?r():r(new Error("以英文字母开头，只能包含英文字母、数字、下划线"))};return{registerForm:{},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{validator:r,trigger:"change"},{validator:s,trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:2,max:15,message:"长度在 2 到 15 个字符",trigger:"change"},{validator:a,trigger:"change"}],repassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:t,trigger:"change"}]}}},mounted:function(){var e=this;document.onkeydown=function(t){var r=window.event.keyCode;13===r&&e.submitForm("registerFormref")},""===this.registerForm.username?this.$refs.username.focus():""===this.registerForm.password&&this.$refs.password.focus()},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(r){var s,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",!1);case 2:return delete t.registerForm.repassword,e.next=5,t.$http.post("user/doregist",t.registerForm);case 5:s=e.sent,a=s.data,200===a.code?(t.$message({type:"success",message:"注册成功！"}),i=a.obj,window.sessionStorage.setItem("user",JSON.stringify(i)),t.$router.push("/")):t.$message({type:"error",message:"注册失败！"});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},reback:function(){this.$router.go(-1)}}},o=n,l=(r("3348"),r("2877")),u=Object(l["a"])(o,s,a,!1,null,"df6e00a8",null);t["default"]=u.exports},"7b7f":function(e,t,r){},ab13:function(e,t,r){var s=r("b622"),a=s("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[a]=!1,"/./"[e](t)}catch(s){}}return!1}},be0e:function(e,t,r){},caad:function(e,t,r){"use strict";var s=r("23e7"),a=r("4d64").includes,i=r("44d2"),n=r("ae40"),o=n("indexOf",{ACCESSORS:!0,1:0});s({target:"Array",proto:!0,forced:!o},{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),i("includes")},dc63:function(e,t,r){},dd7b:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login_container"},[r("div"),r("div",{staticClass:"bg"}),r("div",{staticClass:"login_box"},[r("h1",[e._v("登录")]),r("el-form",{ref:"loginFormref",staticClass:"login-form",attrs:{"lable-width":"0px",model:e.loginForm,rules:e.rules}},[r("el-form-item",{attrs:{prop:"username"}},[r("el-input",{ref:"username",attrs:{placeholder:"手机号"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}},[r("i",{staticClass:"el-input__icon el-icon-phone",attrs:{slot:"prefix"},slot:"prefix"})])],1),r("el-form-item",{attrs:{prop:"password"}},[r("el-input",{ref:"password",attrs:{type:"password",placeholder:"密码"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}},[r("i",{staticClass:"el-input__icon el-icon-lock",attrs:{slot:"prefix"},slot:"prefix"})])],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("loginFormref")}}},[e._v(" 登录 ")])],1),r("el-form-item",[r("router-link",{attrs:{to:"/register"}},[e._v(" 还没有账号？立即注册 ")])],1)],1)],1)])},a=[],i=(r("96cf"),r("1da1")),n={data:function(){return{loginForm:{},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},mounted:function(){var e=this;document.onkeydown=function(t){var r=window.event.keyCode;13===r&&e.submitForm("loginFormref")},""===this.loginForm.username?this.$refs.username.focus():""===this.loginForm.password&&this.$refs.password.focus()},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(r){var s,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,t.$http.post("login",t.loginForm);case 4:s=e.sent,a=s.data,200===a.code?(t.$message({type:"success",message:"登录成功！"}),i=a.obj,window.sessionStorage.setItem("user",JSON.stringify(i)),t.$router.push("/")):t.$message({type:"error",message:a.obj});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},o=n,l=(r("42f2"),r("2877")),u=Object(l["a"])(o,s,a,!1,null,"67c3c9e8",null);t["default"]=u.exports}}]);
//# sourceMappingURL=login-index.0d9fc44f.js.map